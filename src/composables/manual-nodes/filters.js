export const countryCodeMap = {
  'hk': ['ðŸ‡­ðŸ‡°', 'é¦™æ¸¯', 'HK'],
  'tw': ['ðŸ‡¨ðŸ‡³', 'å°æ¹¾', 'è‡ºç£'],
  'sg': ['ðŸ‡¸ðŸ‡¬', 'æ–°åŠ å¡', 'ç‹®åŸŽ'],
  'jp': ['ðŸ‡¯ðŸ‡µ', 'æ—¥æœ¬'],
  'us': ['ðŸ‡ºðŸ‡¸', 'ç¾Žå›½', 'ç¾Žåœ‹'],
  'kr': ['ðŸ‡°ðŸ‡·', 'éŸ©å›½', 'éŸ“åœ‹'],
  'gb': ['ðŸ‡¬ðŸ‡§', 'è‹±å›½', 'è‹±åœ‹'],
  'uk': ['ðŸ‡¬ðŸ‡§', 'è‹±å›½', 'è‹±åœ‹'],
  'de': ['ðŸ‡©ðŸ‡ª', 'å¾·å›½', 'å¾·åœ‹'],
  'fr': ['ðŸ‡«ðŸ‡·', 'æ³•å›½', 'æ³•åœ‹'],
  'ca': ['ðŸ‡¨ðŸ‡¦', 'åŠ æ‹¿å¤§'],
  'au': ['ðŸ‡¦ðŸ‡º', 'æ¾³å¤§åˆ©äºš', 'æ¾³æ´²', 'æ¾³å¤§åˆ©äºž'],
  'cn': ['ðŸ‡¨ðŸ‡³', 'ä¸­å›½', 'å¤§é™¸', 'å†…åœ°'],
  'my': ['ðŸ‡²ðŸ‡¾', 'é©¬æ¥è¥¿äºš', 'é¦¬ä¾†è¥¿äºž'],
  'th': ['ðŸ‡¹ðŸ‡­', 'æ³°å›½', 'æ³°åœ‹'],
  'vn': ['ðŸ‡»ðŸ‡³', 'è¶Šå—'],
  'ph': ['ðŸ‡µðŸ‡­', 'è²å¾‹å®¾', 'è²å¾‹è³“'],
  'id': ['ðŸ‡®ðŸ‡©', 'å°åº¦å°¼è¥¿äºš', 'å°å°¼'],
  'in': ['ðŸ‡®ðŸ‡³', 'å°åº¦'],
  'pk': ['ðŸ‡µðŸ‡°', 'å·´åŸºæ–¯å¦'],
  'bd': ['ðŸ‡§ðŸ‡©', 'å­ŸåŠ æ‹‰å›½', 'å­ŸåŠ æ‹‰åœ‹'],
  'ae': ['ðŸ‡¦ðŸ‡ª', 'é˜¿è”é…‹', 'é˜¿è¯é…‹'],
  'sa': ['ðŸ‡¸ðŸ‡¦', 'æ²™ç‰¹é˜¿æ‹‰ä¼¯'],
  'tr': ['ðŸ‡¹ðŸ‡·', 'åœŸè€³å…¶'],
  'ru': ['ðŸ‡·ðŸ‡º', 'ä¿„ç½—æ–¯', 'ä¿„ç¾…æ–¯'],
  'br': ['ðŸ‡§ðŸ‡·', 'å·´è¥¿'],
  'mx': ['ðŸ‡²ðŸ‡½', 'å¢¨è¥¿å“¥'],
  'ar': ['ðŸ‡¦ðŸ‡·', 'é˜¿æ ¹å»·'],
  'cl': ['ðŸ‡¨ðŸ‡±', 'æ™ºåˆ©'],
  'za': ['ðŸ‡¿ðŸ‡¦', 'å—éž'],
  'eg': ['ðŸ‡ªðŸ‡¬', 'åŸƒåŠ'],
  'ng': ['ðŸ‡³ðŸ‡¬', 'å°¼æ—¥åˆ©äºš', 'å°¼æ—¥åˆ©äºž'],
  'ke': ['ðŸ‡°ðŸ‡ª', 'è‚¯å°¼äºš', 'è‚¯å°¼äºž'],
  'il': ['ðŸ‡®ðŸ‡±', 'ä»¥è‰²åˆ—'],
  'ir': ['ðŸ‡®ðŸ‡·', 'ä¼Šæœ—'],
  'iq': ['ðŸ‡®ðŸ‡¶', 'ä¼Šæ‹‰å…‹'],
  'ua': ['ðŸ‡ºðŸ‡¦', 'ä¹Œå…‹å…°', 'çƒå…‹è˜­'],
  'pl': ['ðŸ‡µðŸ‡±', 'æ³¢å…°', 'æ³¢è˜­'],
  'cz': ['ðŸ‡¨ðŸ‡¿', 'æ·å…‹'],
  'hu': ['ðŸ‡­ðŸ‡º', 'åŒˆç‰™åˆ©'],
  'ro': ['ðŸ‡·ðŸ‡´', 'ç½—é©¬å°¼äºš', 'ç¾…é¦¬å°¼äºž'],
  'gr': ['ðŸ‡¬ðŸ‡·', 'å¸Œè…Š', 'å¸Œè‡˜'],
  'pt': ['ðŸ‡µðŸ‡¹', 'è‘¡è„ç‰™'],
  'es': ['ðŸ‡ªðŸ‡¸', 'è¥¿ç­ç‰™'],
  'it': ['ðŸ‡®ðŸ‡¹', 'æ„å¤§åˆ©'],
  'nl': ['ðŸ‡³ðŸ‡±', 'è·å…°', 'è·è˜­'],
  'be': ['ðŸ‡§ðŸ‡ª', 'æ¯”åˆ©æ—¶', 'æ¯”åˆ©æ™‚'],
  'se': ['ðŸ‡¸ðŸ‡ª', 'ç‘žå…¸'],
  'no': ['ðŸ‡³ðŸ‡´', 'æŒªå¨'],
  'dk': ['ðŸ‡©ðŸ‡°', 'ä¸¹éº¦', 'ä¸¹éº¥'],
  'fi': ['ðŸ‡«ðŸ‡®', 'èŠ¬å…°', 'èŠ¬è˜­'],
  'ch': ['ðŸ‡¨ðŸ‡­', 'ç‘žå£«'],
  'at': ['ðŸ‡¦ðŸ‡¹', 'å¥¥åœ°åˆ©', 'å¥§åœ°åˆ©'],
  'ie': ['ðŸ‡®ðŸ‡ª', 'çˆ±å°”å…°', 'æ„›çˆ¾è˜­'],
  'nz': ['ðŸ‡³ðŸ‡¿', 'æ–°è¥¿å…°', 'ç´è¥¿è˜­'],
};

export function isManualNodeEntry(item) {
  if (!item.url) return false;
  if (typeof item.url !== 'string') return false;

  const trimmedUrl = item.url.trim();
  if (!trimmedUrl) return false;

  if (/^https?:\/\//i.test(trimmedUrl)) return false;

  const validProtocols = /^(ss|ssr|vmess|vless|trojan|hysteria2?|hy2|tuic|snell|naive|socks5|socks|http|anytls):\/\//i;
  return validProtocols.test(trimmedUrl);
}

export function filterManualNodes(nodes, searchTerm, activeColorFilter) {
  let filtered = nodes;

  if (activeColorFilter) {
    filtered = filtered.filter(n => n.colorTag === activeColorFilter);
  }

  if (!searchTerm) {
    return filtered;
  }

  const searchQuery = searchTerm.toLowerCase().trim();
  const alternativeTerms = countryCodeMap[searchQuery] || [];

  return filtered.filter(node => {
    if (!node.name) return false;
    const nodeName = node.name.toLowerCase();
    if (nodeName.includes(searchQuery)) return true;
    for (const altTerm of alternativeTerms) {
      if (nodeName.includes(altTerm.toLowerCase())) return true;
    }
    return false;
  });
}
